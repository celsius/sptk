% ----------------------------------------------------------------
%       Speech Signal Processing Toolkit (SPTK): version 3.0
%                      SPTK Working Group
% 
%                Department of Computer Science
%                Nagoya Institute of Technology
%                             and
%   Interdisciplinary Graduate School of Science and Engineering
%                Tokyo Institute of Technology
%                   Copyright (c) 1984-2000
%                     All Rights Reserved.
% 
% Permission is hereby granted, free of charge, to use and
% distribute this software and its documentation without
% restriction, including without limitation the rights to use,
% copy, modify, merge, publish, distribute, sublicense, and/or
% sell copies of this work, and to permit persons to whom this
% work is furnished to do so, subject to the following conditions:
% 
%   1. The code must retain the above copyright notice, this list
%      of conditions and the following disclaimer.
% 
%   2. Any modifications must be clearly marked as such.
%                                                                        
% NAGOYA INSTITUTE OF TECHNOLOGY, TOKYO INSITITUTE OF TECHNOLOGY,
% SPTK WORKING GROUP, AND THE CONTRIBUTORS TO THIS WORK DISCLAIM
% ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL
% IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT
% SHALL NAGOYA INSTITUTE OF TECHNOLOGY, TOKYO INSITITUTE OF
% TECHNOLOGY, SPTK WORKING GROUP, NOR THE CONTRIBUTORS BE LIABLE
% FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY
% DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
% WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
% ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
% PERFORMANCE OF THIS SOFTWARE.
% ----------------------------------------------------------------
%
\name{levdur}{レビンソン・ダービンの算法}{信号処理}

\begin{synopsis}
 \item [levdur] [ --m $M$ ] [ {\em infile} ] 
\end{synopsis}

\begin{qsection}{DESCRIPTION}
自己相関行列から線形方程式を解き，線形予測係数を求めます．
指定されたファイルから $M$ 次の自己相関数列
\begin{displaymath}
  r(0),r(1),\ldots,r(M)
\end{displaymath}
を読み込み，レビンソン・ダービンの算法により線形方程式を解きます．
\par
データ形式は入力，出力ともfloat 形式です．
\par
線形予測係数は全極型ディジタルフィルタ
\begin{displaymath}
H(z) = \frac{K}{\displaystyle{1+\sum_{i=1}^{M}a(k)z^{-i}}}
\end{displaymath}
の係数 $K, a(1), \ldots, a(M)$ です。
線形予測分析の自己相関法では，次の線形方程式
\begin{displaymath}
\left( \begin{array}{cccc}
        r(0) & r(1) & \cdots & r(M-1) \\
        r(1) & r(0) &        & \vdots \\
        \vdots &    & \ddots &         \\
        r(M-1) &    & \cdots & r(0)   \\
        \end{array} \right)
\left( \begin{array}{c}
	a(1) \\
	a(2) \\
	\vdots \\
	a(M) \\
	\end{array} \right)
= - \left( \begin{array}{c}
	r(1) \\
	r(2) \\
	\vdots \\
	r(M) \\
	\end{array} \right)
\end{displaymath}
を解くことで線形予測係数を求めます．
この際，係数行列の Toeplitz 性を利用することにより，
次のようなダービンの再帰法で効率的に計算することができます．
\begin{eqnarray}
E^{(0)}    &=& r(0) \\
k(i)       &=& \frac{\displaystyle{-r(i)-\sum_{j=1}^i a^{(i-1)}(j)r(i-j)}}
		{E^{(i-1)}} \label{eqn:lev_dur_k}\\
a^{(i)}(i) &=& k(i) \\
a^{(i)}(j) &=&  a^{(i-1)}(j) + k(i) a^{(i-1)}(i-j), 
		~~~~~1\leq j \leq i-1\\
E^{(i)}    &=& (1-k^2(i)) E^{(i-1)} \label{eqn:lev_dur_E}
\end{eqnarray}
ただし，式(\ref{eqn:lev_dur_k})から(\ref{eqn:lev_dur_E})を $i=1,2,\ldots,M$ の
順に繰り返します．
また，ゲイン $K$ は
\begin{displaymath}
K = \sqrt{E^{(M)}}
\end{displaymath}
で求めます．
\end{qsection}

\begin{options}
	\argm{m}{M}{分析次数．}{25}
\end{options}

\begin{qsection}{EXAMPLE}
float形式のファイル {\em data.f} を線形予測分析し，線形予測係数を 
{\em data.lpc} に出力する:
\begin{quote}
 \verb!frame < data.f | window | acorr -m 25 | levdur > data.lpc!
\end{quote} 
\end{qsection}

\begin{qsection}{SEE ALSO}
 acorr, lpc
\end{qsection}
